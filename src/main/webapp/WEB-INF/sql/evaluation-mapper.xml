<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="EvaluationRepository">

  <select id="select" resultType="map">
    SELECT * FROM EVALUATION WHERE Evaluation_ID = #{value}
  </select>

  <select id="selectAll" resultType="map">
    SELECT * FROM EVALUATION
  </select>

  <select id="selectL" resultType="map">
    SELECT * FROM EVALUATION WHERE LECTURE_ID = #{value} AND IS_DELETE <![CDATA[ = ]]> 1
  </select>

  <select id="selectCount" resultType="int">
    SELECT Count(evaluation_id) FROM EVALUATION WHERE MEMBER_ID = #{member_id} AND LECTURE_ID = #{lecture_id}
  </select>

  <select id="selectMember" resultType="String">
    SELECT member_id FROM EVALUATION WHERE Evaluation_ID = #{evaluation_id}
  </select>

<!--  <select id="selectL" resultType="map">
    SELECT * FROM EVALUATION E LEFT OUTER JOIN LECTURE L ON E.LECTURE_ID=L.LECTURE_ID WHERE E.LECTURE_ID = #{value}
  </select>-->

  <delete id="delete" parameterType="int">
    DELETE FROM EVALUATION WHERE EVALUATION_ID = #{value}
  </delete>

  <update id="isDelete" parameterType="map">
    UPDATE EVALUATION
    SET
    IS_DELETE = 0
    WHERE EVALUATION_ID = #{evaluation_id}
  </update>

  <insert id="insert" parameterType="map">
    INSERT INTO EVALUATION (lecture_id, member_id, method, task, exam, comment, score)
    VALUES (#{lecture_id},#{member_id},#{method},#{task},#{exam},#{comment},#{score})
  </insert>

  <update id="update" parameterType="map">
    UPDATE EVALUATION
    SET
    method = #{method},
    task = #{task},
    exam = #{exam},
    comment = #{comment},
    score = #{score}
    WHERE EVALUATION_ID = #{evaluation_id}
  </update>

  <update id="updateLike" parameterType="map">
    UPDATE EVALUATION
    SET
    likes = likes + 1
    WHERE EVALUATION_ID = #{evaluation_id}
  </update>

  <update id="updateDislike" parameterType="map">
    UPDATE EVALUATION
    SET
    dislike = dislike + 1
    WHERE EVALUATION_ID = #{evaluation_id}
  </update>

  <update id="updateReport" parameterType="map">
    UPDATE EVALUATION
    SET
    report = report + 1
    WHERE EVALUATION_ID = #{evaluation_id}
  </update>

  <insert id="insertSub" parameterType="map">
    INSERT INTO EVALUATIONSUB (evaluation_id, member_id)
    VALUES (#{evaluation_id},#{member_id})
  </insert>

  <select id="selectSub" parameterType="map" resultType="int" >
    SELECT Count(ES_ID) FROM EVALUATIONSUB WHERE EVALUATION_ID = #{evaluation_id} AND MEMBER_ID = #{member_id}
  </select>

</mapper>